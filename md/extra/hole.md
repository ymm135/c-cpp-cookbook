- # 漏洞挖掘与利用

## 漏洞与利用
安全漏洞和利用的本质：
攻击者精心构造的数据从一个`攻击界面`经过传播到达另一个`攻击界面`的处理它的代码，改变或获得其想要的`控制流`，从而造成获得不同的权限或能力。  

### UAF(Use-After-Free)
Simple UAF
- ObjectA被Malloc
- ObjectA被Free
- ObjectA所在空间被重新分配(ObjectB)
- ObjectA被再次使用

UAF的原理很容易理解。当程序尝试访问先前已被释放的内存区时，就会出现`Use-After-Free`漏洞。在这种情况下创建的悬空指针将指向内存中已经释放的对象。  

举个例子，下面的代码将导致一个UAF漏洞。如果下面的代码在运行过程中执行了if分支语句的话，由于指针ptr指向无效的存储器区，所以可能发生不确定的行为。  

```c
char * ptr = malloc(SIZE); 
… 
if (error){ 
    free(ptr); 
} 
… 
printf("%s", ptr); 
```

换句话说，如果发生如下所示的3个步骤，就会出现UAF漏洞：

（1）分配一个内存区并且让一个指针指向它。  

（2）内存区被释放，但原来的指针仍然可用。  

（3）使用该指针访问先前释放的内存区。  

大多数时候，UAF漏洞会只会导致信息泄漏，但有的时候，它还可能导致代码执行——攻击者对这种情况更感兴趣。导致代码执行通常发生在下列情况下：

程序分配了内存块A，后来将其释放了。  
攻击者分配了内存块B，并且该内存块使用的就是之前分配给内存块A的那片内存。  
攻击者将数据写入内存块B。  
程序使用之前释放的内存块A，访问攻击者留下的数据。  

在C++中，当类A被释放后，攻击者立刻在原来A所在的内存区上建立一个类B的时候，就经常出现这种漏洞。这样的话，当调用类A的方法的时候，实际上执行的是攻击者加载到类B中的代码。

## Fuzz  

模糊测试 （fuzz testing, fuzzing）是一种软件测试技术。其核心思想是将自动或半自动生成的随机数据输入到一个程序中，并监视程序异常，如崩溃，断言（assertion）失败，以发现可能的程序错误，比如内存泄漏。模糊测试常常用于检测软件或计算机系统的安全漏洞。



